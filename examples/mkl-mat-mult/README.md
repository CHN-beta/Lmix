# Example 1

## mkl-mat-mult

A useless fortran program that performs a large matrix multiplication with the dgemm subroutine from the LAPACK implementation of the Intel oneAPI Math Kernel Library.

## Flake generation

The flake has been autogenerated using lmod2flake with the intel-oneapi-mkl module loaded:
```
$ nix run . -- ./examples/mkl-fortran -c intel21IFort
```
The first argument specifies the target directory. The next option includes the ifort compiler and sets the environment variable FC to ifort. An environment variable set to the base path of MKL which the Makefile requires has been included manually.

## Building

The Makefile specifies two targets: `mat_mult_seq` and `mat_mult_par` where the first one runs sequential and the second one linking with implicit openmp which results in a faster execution time.
```
$ nix develop
$ make mat_mult_seq
$ make mat_mult_par
```
